## レプリケーションについてのメモ

マスタサーバの DB をサブのスレーブサーバに配布する仕組み。
負荷が高い参照処理をスレーブサーバを利用し、データの作成などを処理をマスタサーバで行うことをリードレプリカという。

### 仕組み

スレーブの I/O スレッドが、マスターからのバイナリログの情報を受け取りその情報を一旦リレーログファイルに書き込む。
そして、SQL スレッドがそのリレーファイルがから更新情報を読み取り、データベースに適用する。

### バイナリログ

テーブル作成操作やテーブルデータへの変更などのデータベース変更を記述する「イベント」が格納される。

バイナリログを使用する目的は下記の 2 つ。

- スレーブサーバーにデータ変更のレコードを提供する。
- 特定のデータリカバリー操作時に使用する。バックアップをリストアした後、バックアップが実行された後に記録されたバイナリログ内のイベントが再実行される。

### リレーログファイル

スレーブのみに生成されるファイル。
ファイルの生成タイミングは、下記になる。

- `CHANGE MASTER`でマスターの変更が行われた時
- `RESET SLAVE`が行われた時

今回は、slave の作成時に、`CHANGE MASTER`を利用して master の設定をしたので、そのタイミングでリレーログファイルが作成されたことになる。

参考
[MySQL 入門　レプリケーション編 \- Qiita](https://qiita.com/Tocyuki/items/c224cef57493f536a941)
[MySQL :: MySQL 5\.6 リファレンスマニュアル :: 5\.2\.4 バイナリログ](https://dev.mysql.com/doc/refman/5.6/ja/binary-log.html)
[第 53 回　リレーログファイルについて \| gihyo\.jp](https://gihyo.jp/dev/serial/01/mysql-road-construction-news/0053)
